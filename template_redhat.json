{
   "variables":{
      "aws_access_key":"",
      "aws_secret_key":""
   },
   "builders":[
      {
         "type":"amazon-ebs",
         "access_key":"{{user `aws_access_key`}}",
         "secret_key":"{{user `aws_secret_key`}}",
         "region":"us-west-1",
         "source_ami_filter":{
            "filters":{
               "virtualization-type":"hvm",
               "name":"RHEL-7.5_HVM_GA-20180322-x86_64-1-Hourly2-GP2",
               "root-device-type":"ebs"
            },
            "owners":[
               "309956199498"
            ],
            "most_recent":true
         },
         "instance_type":"t2.micro",
         "ssh_username":"ec2-user",
         "ami_name":"packer-example {{timestamp}}"
      }
   ],
   "provisioners":[
      {
         "type":"shell",
         "inline":[
            "sleep 5"
         ]
      },
      {
         "type":"file",
         "source":"./playb.repo",
         "destination":"/tmp/"
      },
      {
         "type":"file",
         "source":"./welcome.txt",
         "destination":"/home/ec2-user/"
      },
      {
         "type":"shell",
         "inline":[
            "sudo cp /tmp/playb.repo /etc/yum.repos.d/",
            "ls -al /etc/yum.repos.d",
            "cat /etc/yum.repos.d/playb.repo"
         ]
      },
      {
         "type":"shell",
         "script":"./example.sh"
      },
      {
         "type":"shell",
         "inline":[
            "sleep 10",
            "sudo yum install -y ansible"
            
         ]
      }
   ]
}
